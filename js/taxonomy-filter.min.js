"use strict";class TaxonomyFilter{initEventHandlers(){const e=document.querySelector("#taxonomy-filter #submit");if(!e)throw new Error('Could not find button "#taxonomy-filter #submit"');const t=document.querySelector("#taxonomy-filter #reset");if(!t)throw new Error('Could not find button "#taxonomy-filter #reset"');e.addEventListener("click",e=>{e.preventDefault();let t=this.getCleanPathname();t=this.addTaxonomyFiltersToPathname(t),window.location.href=t}),t.addEventListener("click",e=>{e.preventDefault(),this.clearFields();const t=this.getCleanPathname();window.location.href=t})}clearFields(){var e,t;const n=document.querySelectorAll('#taxonomy-filter input[type="checkbox"]');for(const e of n)e.checked=!1;null===(e=document.getElementById("starts-after"))||void 0===e||e.setAttribute("value",""),null===(t=document.getElementById("starts-before"))||void 0===t||t.setAttribute("value","")}getCleanPathname(){let e=document.location.pathname;const t=document.querySelectorAll('#taxonomy-filter input[type="checkbox"]');for(const n of t){const[t]=n.name.split("-"),o=new RegExp(`/${t}:[^/]+`);e=e.replace(o,"")}return e=e.replace(/(starts-after|ends-before):[^\/]+/g,""),e=e.replace(/\/page:\d+/,""),e.replace(/\/\//g,"/")||"/"}addTaxonomyFiltersToPathname(e){const t=document.getElementById("taxonomy-filter"),n=new FormData(t),o={};for(const e of n.keys()){if(e.match(/(starts-after|ends-before)/))continue;const[t,n]=e.split("-");o[t]||(o[t]=""),o[t]+=o[t]?","+n:n}const r=n.get("starts-after"),a=n.get("ends-before");r&&(o["starts-after"]=r),a&&(o["ends-before"]=a);let l="";for(const e of Object.entries(o))l+=`/${e[0]}:${e[1]}`;return(e+l).replace(/\/\//g,"/")}}(new TaxonomyFilter).initEventHandlers();
